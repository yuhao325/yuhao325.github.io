<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A10班高校蹭饭地图</title>
    <script src="echarts.min.js"></script>
    <script src="china.js"></script>
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" href="font-awesome.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2d388a, #4a4b8c);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
            position: relative;
        }
        
        h1 {
            font-size: 2.8rem;
            letter-spacing: 2px;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(100, 200, 255, 0.7);
            background: linear-gradient(90deg, #ff9a9e, #fad0c4, #fbc2eb, #a6c1ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 8s ease infinite;
            background-size: 400% 400%;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.85;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .stats-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 20px;
            flex: 1;
            min-width: 200px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.12);
        }
        
        .stat-title {
            font-size: 1rem;
            opacity: 0.7;
            margin-bottom: 10px;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .chart-container {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            margin-bottom: 40px;
        }
        
        .map-section {
            flex: 2;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .chart-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-title i {
            color: #4facfe;
        }
        
        .city-list {
            flex: 1;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .city-tags-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .show-all-btn {
            background: rgba(79, 172, 254, 0.3);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .show-all-btn:hover {
            background: rgba(255, 215, 0, 0.4);
            transform: scale(1.05);
        }
        
        .city-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .city-table th {
            text-align: left;
            padding: 12px 15px;
            font-weight: 500;
            opacity: 0.7;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .city-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .city-table tr:hover td {
            background: rgba(255, 255, 255, 0.08);
            cursor: pointer;
        }
        
        .student-name {
            font-weight: 500;
        }
        
        .city-name {
            opacity: 0.9;
        }
        
        .count-badge {
            display: inline-block;
            min-width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            border-radius: 12px;
            text-align: center;
            line-height: 24px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 5px;
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            opacity: 0.7;
            font-size: 0.9rem;
        }
        
        .highlight {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 4px;
            padding: 2px 4px;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        .city-tag {
            display: inline-block;
            padding: 3px 12px;
            background: rgba(79, 172, 254, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            margin-right: 8px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }
        
        .city-tag:hover {
            transform: scale(1.05);
            background: rgba(255, 215, 0, 0.3);
            cursor: pointer;
        }
        
        .city-tag .count {
            font-weight: bold;
            margin-left: 5px;
        }
        
        .no-data {
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
        }

        .table-container {
            max-height: 400px; /* 调整为与地图高度匹配 */
            overflow-y: auto;
            border-radius: 8px;
            margin-top: 10px;
            scrollbar-width: thin;
            scrollbar-color: rgba(79, 172, 254, 0.5) rgba(255, 255, 255, 0.1);
        }

        /* 自定义滚动条样式 */
        .table-container::-webkit-scrollbar {
            width: 8px;
        }

        .table-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: rgba(79, 172, 254, 0.5);
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: rgba(79, 172, 254, 0.8);
        }
        
        @media (max-width: 768px) {
            .chart-container {
                flex-direction: column;
            }
            
            .stats-container {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .city-tags-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }

        /* 添加在现有CSS中 */
        #map {
            height: 600px;
            width: 100%;
            border-radius: 15px;
            overflow: hidden;
            background: rgba(30, 50, 100, 0.3); /* 添加背景色增强地图可见性 */
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            padding-left: 30px;
            padding-bottom: 30px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="floating">🍜 西工大附中高2025届A10班高校蹭饭地图</h1>
            <p class="subtitle">展示56名同学在全国高校的城市分布情况，快来看看哪些城市有你的同学，方便以后蹭饭！</p>
        </header>
        
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-title">总人数</div>
                <div class="stat-value">56</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">覆盖城市</div>
                <div class="stat-value">20</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">覆盖省市</div>
                <div class="stat-value">18</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">热门城市</div>
                <div class="stat-value">西安</div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="map-section">
                <div class="chart-title">
                    <i class="fa fa-map-marked-alt"></i>
                    <span>高校城市分布地图</span>
                </div>
                <div id="map"></div>
            </div>
            
            <div class="city-list">
                <div class="list-header">
                    <div class="chart-title">
                        <i class="fa fa-city"></i>
                        <span>城市分布详情</span>
                    </div>
                </div>
                
                <div class="city-tags-header">
                    <h3>热门城市：</h3>
                    <button class="show-all-btn" id="showAllBtn">
                        <i class="fa fa-users"></i> 显示全部同学
                    </button>
                </div>

                <div class="city-tags" style="margin-bottom: 20px;">
                    <div class="city-tag" data-city="西安">西安 <span class="count">23</span></div>
                    <div class="city-tag" data-city="北京">北京 <span class="count">6</span></div>
                    <div class="city-tag" data-city="南京">南京 <span class="count">4</span></div>
                    <div class="city-tag" data-city="杨凌">杨凌 <span class="count">3</span></div>
                    <div class="city-tag" data-city="上海">上海 <span class="count">2</span></div>
                    <div class="city-tag" data-city="贵阳">贵阳 <span class="count">2</span></div>
                    <div class="city-tag" data-city="哈尔滨">哈尔滨 <span class="count">2</span></div>
                    <div class="city-tag" data-city="长沙">长沙 <span class="count">2</span></div>
                </div>
                <!-- 替换原有表格结构 -->
                <div class="table-container">
                    <table class="city-table">
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th>姓名</th>
                            <th>所在城市</th>
                        </tr>
                        </thead>
                        <tbody id="cityTableBody">
                        <!-- 数据将通过JS填充 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="popular-cities">
            <div class="chart-title">
                <i class="fa fa-chart-bar"></i>
                <span>热门城市分布</span>
            </div>
            <div id="barChart" style="height: 400px; width: 100%; border-radius: 15px; background: rgba(255,255,255,0.05); padding: 20px;"></div>
        </div>
        
        <footer>
            <p>数据来源：A10录取统计 | 祝所有同学大学生活愉快！</p>
        </footer>
    </div>

    <script>
        // 学生数据（包含所有56名学生）
        const studentData = [
            { id: 1, name: "蔡昕辰", city: "重庆", province: "重庆" },
            { id: 2, name: "曹博涵", city: "西安", province: "陕西" },
            { id: 3, name: "陈思宇", city: "西安", province: "陕西" },
            { id: 4, name: "寸金烨", city: "西安", province: "陕西" },
            { id: 5, name: "段力铭", city: "北京", province: "北京" },
            { id: 6, name: "冯泽坤", city: "贵阳", province: "贵州" },
            { id: 7, name: "郭家荣", city: "北京", province: "北京" },
            { id: 8, name: "郭轩齐", city: "暂无数据", province: "暂无数据" },
            { id: 9, name: "郭以歌", city: "北京", province: "北京" },
            { id: 10, name: "贾若择", city: "西安", province: "陕西" },
            { id: 11, name: "蒋轶轩", city: "西安", province: "陕西" },
            { id: 12, name: "康佳瑞", city: "西安", province: "陕西" },
            { id: 13, name: "李翰阳", city: "暂无数据", province: "暂无数据" },
            { id: 14, name: "李恒旭", city: "杨凌", province: "陕西" },
            { id: 15, name: "李斯楠", city: "贵阳", province: "贵州" },
            { id: 16, name: "李一娴", city: "哈尔滨", province: "黑龙江" },
            { id: 17, name: "李奕辰", city: "西安", province: "陕西" },
            { id: 18, name: "李玥璁", city: "天津", province: "天津" },
            { id: 19, name: "李玥晓", city: "西安", province: "陕西" },
            { id: 20, name: "李子桐", city: "西安", province: "陕西" },
            { id: 21, name: "林辰泽", city: "西安", province: "陕西" },
            { id: 22, name: "刘佳琦", city: "哈尔滨", province: "黑龙江" },
            { id: 23, name: "刘晰月", city: "上海", province: "上海" },
            { id: 24, name: "刘熙源", city: "长沙", province: "湖南" },
            { id: 25, name: "刘星宇", city: "郑州", province: "河南" },
            { id: 26, name: "刘弈宏", city: "西安", province: "陕西" },
            { id: 27, name: "潘子杨", city: "南京", province: "江苏" },
            { id: 28, name: "秦士鹏", city: "西安", province: "陕西" },
            { id: 29, name: "屈之彧", city: "暂无数据", province: "暂无数据" },
            { id: 30, name: "权晨阳", city: "太原", province: "山西" },
            { id: 31, name: "盛朝阳", city: "深圳", province: "广东" },
            { id: 32, name: "史海洋", city: "西安", province: "陕西" },
            { id: 33, name: "史康男", city: "长沙", province: "湖南" },
            { id: 34, name: "史雅昕", city: "西安", province: "陕西" },
            { id: 35, name: "陶奕丞", city: "杨凌", province: "陕西" },
            { id: 36, name: "王晨昊", city: "西安", province: "陕西" },
            { id: 37, name: "王晨宇", city: "西安", province: "陕西" },
            { id: 38, name: "王晰语", city: "成都", province: "四川" },
            { id: 39, name: "王奕博", city: "保定", province: "河北" },
            { id: 40, name: "吴莺莺", city: "西安", province: "陕西" },
            { id: 41, name: "校昀泽", city: "南宁", province: "广西" },
            { id: 42, name: "熊帝翰", city: "西安", province: "陕西" },
            { id: 43, name: "徐培垚", city: "南京", province: "江苏" },
            { id: 44, name: "闫怡凡", city: "北京", province: "北京" },
            { id: 45, name: "杨子锐", city: "暂无数据", province: "暂无数据" },
            { id: 46, name: "耶昱昊", city: "北京", province: "北京" },
            { id: 47, name: "张皓洋", city: "西安", province: "陕西" },
            { id: 48, name: "张恒嘉", city: "北京", province: "北京" },
            { id: 49, name: "张江岳", city: "西安", province: "陕西" },
            { id: 50, name: "张锦钰", city: "上海", province: "上海" },
            { id: 51, name: "张敬轩", city: "西安", province: "陕西" },
            { id: 52, name: "张乐之", city: "西安", province: "陕西" },
            { id: 53, name: "张熠睿", city: "南京", province: "江苏" },
            { id: 54, name: "赵浩成", city: "杨凌", province: "陕西" },
            { id: 55, name: "赵婧涵", city: "南京", province: "江苏" },
            { id: 56, name: "周瑞甫", city: "西安", province: "陕西" }
        ];
        
        // 1. 渲染表格
        function renderTable(data) {
            const tbody = document.getElementById('cityTableBody');
            tbody.innerHTML = '';
            
            data.forEach(student => {
                const row = document.createElement('tr');
                const cityDisplay = student.city === "暂无数据" ? 
                    `<span class="no-data">暂无数据</span>` : 
                    student.city;
                
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td class="student-name">${student.name}</td>
                    <td class="city-name">${cityDisplay}</td>
                `;
                row.addEventListener('click', () => {
                    highlightCity(student.city);
                });
                tbody.appendChild(row);
            });
        }
        
        // 2. 初始化地图 - 修复地图显示问题
        function initMap() {
            const chartDom = document.getElementById('map');
            const myChart = echarts.init(chartDom);

            // 统计每个省份的学生数量（排除"暂无数据"）
            const provinceCount = {};
            studentData.forEach(student => {
                if (student.province && student.province !== "暂无数据") {
                    provinceCount[student.province] = (provinceCount[student.province] || 0) + 1;
                }
            });

            // 转换为地图数据格式
            const mapData = Object.keys(provinceCount).map(province => {
                return {
                    name: province,
                    value: provinceCount[province]
                };
            });

            // 找出最大值用于视觉映射
            const maxValue = Math.max(...Object.values(provinceCount));

            // 配置项 - 改为区域着色图并锁定地图
            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: function(params) {
                        return `<strong>${params.name}</strong><br/>同学人数: ${params.value || 0}`;
                    }
                },
                visualMap: {
                    show: true,
                    min: 0,
                    max: maxValue,
                    calculable: false,
                    inRange: {
                        color: ['#fff0dc', '#ff8b00', '#ff8b00', '#ff8b00', '#ff8b00']
                    },
                },
                geo: {
                    map: 'china',
                    roam: false, // 禁止拖动和缩放
                    label: {
                        show: false,
                    },
                    itemStyle: {
                        normal: {
                            areaColor: '#fff0dc',
                            borderColor: '#2a3879',
                            borderWidth: 0.3
                        },
                        emphasis: {
                            areaColor: '#ecff00',
                            borderWidth: 0.5
                        }
                    },
                    emphasis: {
                        label: {
                            show: false,
                        },
                        itemStyle: {
                            areaColor: '#ecff00'
                        }
                    },
                    select: {
                        label: {
                            show: false,
                        },
                        itemStyle: {
                            areaColor: '#fff0dc'
                        }
                    }
                },
                series: [{
                    name: '同学人数',
                    type: 'map',
                    mapType: 'china',
                    geoIndex: 0,
                    data: mapData,
                    showLegendSymbol: true,
                    emphasis: {
                        label: {
                            show: false
                        }
                    }
                }]
            };

            myChart.setOption(option);

            // 响应式调整
            window.addEventListener('resize', function() {
                myChart.resize();
            });

            return myChart;
        }
        
        // 3. 初始化柱状图 - 确保降序排列
        function initBarChart() {
            const chartDom = document.getElementById('barChart');
            const myChart = echarts.init(chartDom);
            
            // 统计各城市录取人数（排除"暂无数据"）
            const cityCount = {};
            studentData.forEach(student => {
                if (student.city && student.city !== "暂无数据") {
                    cityCount[student.city] = (cityCount[student.city] || 0) + 1;
                }
            });
            
            // 按录取人数排序并取前10（降序）
            const sortedCities = Object.entries(cityCount)
                .sort((a, b) => b[1] - a[1]);
            
            const cityNames = sortedCities.map(item => item[0]);
            const cityCounts = sortedCities.map(item => item[1]);
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    formatter: '{b}: {c}位同学',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    axisLine: {
                        lineStyle: {
                            color: '#fff'
                        }
                    },
                    axisLabel: {
                        color: 'rgba(255, 255, 255, 0.7)'
                    },
                    name: '人数',
                    nameTextStyle: {
                        color: 'rgba(255, 255, 255, 0.7)'
                    }
                },
                yAxis: {
                    type: 'category',
                    data: cityNames,
                    axisLine: {
                        lineStyle: {
                            color: '#fff'
                        }
                    },
                    axisLabel: {
                        color: 'rgba(255, 255, 255, 0.7)'
                    },
                    // 确保从多到少排列（降序）
                    inverse: true
                },
                series: [{
                    name: '同学人数',
                    type: 'bar',
                    data: cityCounts,
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                            { offset: 0, color: '#83bff6' },
                            { offset: 0.5, color: '#188df0' },
                            { offset: 1, color: '#188df0' }
                        ])
                    },
                    emphasis: {
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                { offset: 0, color: '#ff9a9e' },
                                { offset: 0.5, color: '#fad0c4' },
                                { offset: 1, color: '#fbc2eb' }
                            ])
                        }
                    },
                    label: {
                        show: true,
                        position: 'right',
                        color: '#fff',
                        formatter: '{c}人'
                    }
                }]
            };
            
            myChart.setOption(option);
            
            // 响应式调整
            window.addEventListener('resize', function() {
                myChart.resize();
            });
        }
        
        // 4. 高亮显示城市
        function highlightCity(cityName) {
            if (cityName === "暂无数据") return;
            
            const rows = document.querySelectorAll('#cityTableBody tr');
            rows.forEach(row => {
                const cityCell = row.querySelector('.city-name');
                if (cityCell && cityCell.textContent === cityName) {
                    row.style.backgroundColor = 'rgba(255, 215, 0, 0.15)';
                    setTimeout(() => {
                        row.style.backgroundColor = '';
                    }, 2000);
                }
            });
        }
        
        // 5. 设置城市标签点击事件
        function setupCityTags() {
            const tags = document.querySelectorAll('.city-tag');
            tags.forEach(tag => {
                tag.addEventListener('click', function() {
                    const city = this.getAttribute('data-city');
                    const filteredData = studentData.filter(student => student.city === city);
                    renderTable(filteredData);
                });
            });
        }
        
        // 6. 设置"显示全部"按钮
        function setupShowAllButton() {
            const showAllBtn = document.getElementById('showAllBtn');
            showAllBtn.addEventListener('click', function() {
                renderTable(studentData);
            });
        }
        
        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            renderTable(studentData);
            initMap();
            initBarChart();
            setupCityTags();
            setupShowAllButton();
        });
    </script>
</body>
</html>